<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Real Time</title>
    <link type="text/css" href="../css/cupertino/jquery-ui-1.8.16.custom.css" rel="stylesheet"/>
    <link type="text/css" href="../css/dissector.css" rel="stylesheet"/>
    <script type='text/javascript' src='../js/jquery-1.7.min.js'></script>
    <script type='text/javascript' src='../js/highstock-1.0.1.js'></script>
    <script type='text/javascript' src='../js/exporting-1.0.1.js'></script>
    <script type="text/javascript" src="../js/jquery-ui-1.8.16.custom.min.js"></script>

    <script type="text/javascript">
        var chart;
        $(document).ready(function() {
            chart = new Highcharts.StockChart({
                chart: {
                    renderTo: 'chart'
                },
                rangeSelector: {
                    selected: 1
                },
                rangeSelector: {
                    buttons: [
                        { type: 'day', count: 1, text: '1d'},
                        { type: 'all', text: 'All'}
                    ]},
                legend: {
                    enabled: true,
                    verticalAlign: "top"
                },
                exporting: {
                    width: 1024,
                    filename: "realtime",
                    type: "image/png"
                },
                series: [
                    {name: 'Series 1', data:[]},
                    {name: 'Series 2', data:[]},
                    {name: 'Series 3', data:[]},
                    {name: 'Series 4', data:[]}
                ]
            });

            $('#render1, #render2, #render3, #render4').button();
            $('#stop1, #stop2, #stop3, #stop4').button();
            $('#render1').click(function() {

                renderData(null, $('#ta1').val());
            });

        });

        function renderRealTimeData(series, equation) {
            var start = new Date('2011-01-01T10:00:00.000');
            var stop = new Date('2011-10-30T00:00:00.000');
            var socket = new WebSocket('ws://localhost:1081/1.0/metric/get');

            socket.onopen = function() {
                console.info("Socket opened");
                socket.send('{"expression":"' + equation + '","start":"' + start.toISOString() + '", "stop": "' + stop.toISOString() + '"}');
            };

            socket.onmessage = function(event) {
                console.info(event.data);
                var d = $.parseJSON(event.data);
                var point = [(new Date(d.time)).getTime(), d.value];
                series.addPoint(point);
            };
        }

    </script>
</head>
<body>
<div class='banner'><a href='../index.html'>Dissector</a> - Real Time</div>
<div id='chart' style='width: 100%; height: 400px'></div>
<div class='containerWrapper'>
    <div id='options' class='optionsGroup'>
        <div>
            Interval
            <select id='interval'>
                <option value="300000">5 minutes</option>
                <option value="3600000">1 hour</option>
                <option value="86400000">1 day</option>
            </select>
        </div>
    </div>
    <div id='series' class='seriesGroup'>
        <div id='series1'>
            <h3>Series 1</h3>

            <div>
                <textarea id='ta1' rows='3'></textarea>
                <br/>
                <input id='render1' type='button' value='Render'/>
                <input id='stop1' type='button' value='Stop'/>
            </div>
        </div>
        <div id='series2'>
            <h3>Series 2</h3>

            <div>
                <textarea id='ta2' rows='3'></textarea>
                <br/>
                <input id='render2' type='button' value='Render'/>
                <input id='stop2' type='button' value='Stop'/>
            </div>
        </div>
        <div id='series3'>
            <h3>Series 3</h3>

            <div>
                <textarea id='ta3' rows='3'></textarea>
                <br/>
                <input id='render3' type='button' value='Render'/>
                <input id='stop3' type='button' value='Stop'/>
            </div>
        </div>
        <div id='series4'>
            <h3>Series 4</h3>

            <div>
                <textarea id='ta4' rows='3'></textarea>
                <br/>
                <input id='render4' type='button' value='Render'/>
                <input id='stop4' type='button' value='Stop'/>
            </div>
        </div>
    </div>
</div>
</body>
</body>
</html>